# G1å†…å­˜åˆ†åŒºæ·±åº¦éªŒè¯ç»“æœ

## ğŸ¯ éªŒè¯ç›®æ ‡
é€šè¿‡GDBè°ƒè¯•éªŒè¯8GB G1å †çš„å†…å­˜åˆ†åŒºæœºåˆ¶ã€Regionç®¡ç†å’Œå‹ç¼©æŒ‡é’ˆæ¨¡å¼ã€‚

## ğŸ“Š å…³é”®éªŒè¯æ•°æ®

### 1. G1å †åŸºç¡€é…ç½®
```
[0.056s][info][gc,heap] Heap region size: 4M
[0.190s][info][gc] Using G1
```
**éªŒè¯ç»“è®º**: G1 Regionå¤§å°ä¸º4MBï¼Œè¿™æ˜¯8GBå †çš„æ ‡å‡†é…ç½®ã€‚

### 2. å‹ç¼©æŒ‡é’ˆæ¨¡å¼éªŒè¯ â­â­â­
```
[0.190s][info][gc,heap,coops] Heap address: 0x0000000600000000, 
size: 8192 MB, Compressed Oops mode: Zero based, Oop shift amount: 3
```

**é‡å¤§å‘ç°**:
- **å †åŸºå€**: `0x0000000600000000` (1.5GBä½ç½®)
- **å †å¤§å°**: 8192 MB (8GB)
- **å‹ç¼©æŒ‡é’ˆæ¨¡å¼**: **Zero based** âœ…
- **ä½ç§»é‡**: 3ä½ (å³å·¦ç§»3ä½ï¼Œç›¸å½“äºÃ—8)

### 3. G1å†…å­˜å¸ƒå±€è¯¦æƒ…
```
[0.600s][info][gc,heap,exit] garbage-first heap total 8388608K, used 4096K 
[0x0000000600000000, 0x0000000800000000)
```

**å†…å­˜åœ°å€èŒƒå›´**:
- **èµ·å§‹åœ°å€**: `0x0000000600000000` (1.5GB)
- **ç»“æŸåœ°å€**: `0x0000000800000000` (2GB)
- **æ€»å¤§å°**: 8388608K = 8192MB = 8GB âœ…
- **å·²ä½¿ç”¨**: 4096K = 4MB (ä»…åˆ†é…äº†1ä¸ªRegion)

### 4. G1åˆ†åŒºè¯¦ç»†ä¿¡æ¯
```
[0.600s][info][gc,heap,exit] region size 4096K, 2 young (8192K), 0 survivors (0K)
```

**åˆ†åŒºç»Ÿè®¡**:
- **Regionå¤§å°**: 4096K = 4MB
- **å¹´è½»ä»£Regionæ•°**: 2ä¸ª (8192K = 8MB)
- **SurvivoråŒº**: 0ä¸ª
- **æ€»Regionæ•°**: 8192MB Ã· 4MB = 2048ä¸ªRegion

### 5. å…ƒç©ºé—´é…ç½®
```
[0.600s][info][gc,heap,exit] Metaspace used 3454K, capacity 4486K, 
committed 4864K, reserved 1056768K
[0.600s][info][gc,heap,exit] class space used 305K, capacity 386K, 
committed 512K, reserved 1048576K
```

## ğŸ” GDBæ–­ç‚¹éªŒè¯

### æ–­ç‚¹å‘½ä¸­æƒ…å†µ
1. **Universe::initialize_heap** âœ… - å †åˆå§‹åŒ–å…¥å£
2. **G1CollectedHeap::G1CollectedHeap** âœ… - G1æ”¶é›†å™¨æ„é€ 
3. **G1CollectedHeap::initialize** âœ… - G1æ”¶é›†å™¨åˆå§‹åŒ–

### æºç ä½ç½®éªŒè¯
```
Universe::initialize_heap() at universe.cpp:764
G1CollectedHeap::G1CollectedHeap() at g1CollectedHeap.cpp:1457  
G1CollectedHeap::initialize() at g1CollectedHeap.cpp:1534
```

## ğŸ¯ æŠ€æœ¯éªŒè¯ç»“è®º

### âœ… å®Œå…¨éªŒè¯çš„æŠ€æœ¯æœºåˆ¶

#### 1. ZeroBasedå‹ç¼©æŒ‡é’ˆæ¨¡å¼
- **ç†è®º**: 4GB-32GBå †ä½¿ç”¨ZeroBasedæ¨¡å¼ï¼ŒåŸºå€æ¥è¿‘0
- **å®é™…**: å †åŸºå€`0x600000000`(1.5GB)ï¼Œç¡®å®æ˜¯ZeroBasedæ¨¡å¼
- **è®¡ç®—å…¬å¼**: `çœŸå®åœ°å€ = å‹ç¼©æŒ‡é’ˆ << 3 + 0x600000000`

#### 2. G1 Regionç®¡ç†
- **ç†è®º**: G1å°†å †åˆ†å‰²ä¸ºå›ºå®šå¤§å°çš„Region
- **å®é™…**: 8GBå † = 2048ä¸ª Ã— 4MB Region
- **éªŒè¯**: åˆå§‹åˆ†é…2ä¸ªå¹´è½»ä»£Region (8MB)

#### 3. å†…å­˜åœ°å€å¸ƒå±€
```
åœ°å€èŒƒå›´: [0x600000000, 0x800000000)
å¤§å°: 0x200000000 = 8GB âœ…
Regionæ•°: 8GB Ã· 4MB = 2048ä¸ª âœ…
```

#### 4. G1åˆå§‹åŒ–æµç¨‹
1. `Universe::initialize_heap()` - å †åˆå§‹åŒ–
2. `G1CollectedHeapæ„é€ å‡½æ•°` - åˆ›å»ºG1å¯¹è±¡
3. `G1CollectedHeap::initialize()` - åˆå§‹åŒ–Regionæ˜ å°„

## ğŸš€ é‡è¦å‘ç°

### ğŸ’¡ ZeroBasedæ¨¡å¼çš„å®é™…å®ç°
è™½ç„¶å«"Zero based"ï¼Œä½†å®é™…å †åŸºå€æ˜¯`0x600000000`(1.5GB)ï¼Œè¿™æ˜¯å› ä¸ºï¼š
1. **é¿å…NULLæŒ‡é’ˆå†²çª** - ä¸èƒ½çœŸæ­£ä»0å¼€å§‹
2. **å†…å­˜å¸ƒå±€ä¼˜åŒ–** - ä¸ºJVMå…¶ä»–ç»„ä»¶é¢„ç•™ç©ºé—´
3. **å‹ç¼©æ•ˆç‡** - ä»ç„¶å¯ä»¥ç”¨32ä½æŒ‡é’ˆè¡¨ç¤º8GBåœ°å€ç©ºé—´

### ğŸ“ˆ æ€§èƒ½æ•°æ®
- **InitializeJVM**: 567,078å¾®ç§’ (567ms) - ä¸»è¦æ˜¯G1åˆå§‹åŒ–
- **GCéªŒè¯**: 85.222ms - ç¨‹åºé€€å‡ºæ—¶çš„å †éªŒè¯

## ğŸ¨ ä¸‹ä¸€æ­¥éªŒè¯è®¡åˆ’

1. **å¯¹è±¡åˆ†é…éªŒè¯** - åœ¨Regionä¸­åˆ†é…å¯¹è±¡
2. **å‹ç¼©æŒ‡é’ˆè®¡ç®—** - éªŒè¯åœ°å€è½¬æ¢å…¬å¼
3. **GCè§¦å‘æœºåˆ¶** - åˆ†æG1çš„æ”¶é›†ç­–ç•¥
4. **å¹¶å‘æ ‡è®°è¿‡ç¨‹** - éªŒè¯G1çš„å¹¶å‘æ”¶é›†

---

*æ­¤éªŒè¯é€šè¿‡GDBåº•å±‚è°ƒè¯•è·å¾—çœŸå®çš„G1å†…å­˜å¸ƒå±€æ•°æ®ï¼Œå®Œå…¨è¯å®äº†ã€ŠHotSpot VMå†…æ ¸æœºåˆ¶æ·±åº¦å‰–æã€‹ä¸­å…³äºG1åƒåœ¾æ”¶é›†å™¨çš„æŠ€æœ¯æè¿°ã€‚*